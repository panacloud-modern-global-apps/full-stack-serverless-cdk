var __awaiter=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(e){a(e)}}function s(t){try{l(n["throw"](t))}catch(e){a(e)}}function l(t){t.done?r(t.value):i(t.value).then(o,s)}l((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return l([t,e])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(a=o[0]&2?i["return"]:o[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;if(i=0,a)o=[o[0]&2,a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;i=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(a=r.trys,a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(o[0]===6&&r.label<a[1]){r.label=a[1];a=o;break}if(a&&r.label<a[2]){r.label=a[2];r.ops.push(o);break}if(a[2])r.ops.pop();r.trys.pop();continue}o=e.call(t,r)}catch(s){o=[6,s];i=0}finally{n=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n};System.register(["./p-8d9947b8.system.js","@aws-amplify/core","./p-db681dd2.system.js","@aws-amplify/auth","./p-d86390a3.system.js","./p-010e7787.system.js","@aws-amplify/storage","./p-41e4a4af.system.js"],(function(t){"use strict";var e,r,n,i,a,o,s,l,u,c,f,p;return{setters:[function(t){e=t.r;r=t.h},function(t){n=t.Logger;i=t.filenameToContentType;a=t.I18n},function(t){o=t.A},function(){},function(t){s=t.T},function(t){l=t.e},function(t){u=t.Storage},function(t){c=t.i;f=t.c;p=t.p}],execute:function(){var m;var y=new Uint8Array(16);function h(){if(!m){m=typeof crypto!=="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!=="undefined"&&typeof msCrypto.getRandomValues==="function"&&msCrypto.getRandomValues.bind(msCrypto);if(!m){throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")}}return m(y)}var d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function g(t){return typeof t==="string"&&d.test(t)}var b=[];for(var v=0;v<256;++v){b.push((v+256).toString(16).substr(1))}function w(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=(b[t[e+0]]+b[t[e+1]]+b[t[e+2]]+b[t[e+3]]+"-"+b[t[e+4]]+b[t[e+5]]+"-"+b[t[e+6]]+b[t[e+7]]+"-"+b[t[e+8]]+b[t[e+9]]+"-"+b[t[e+10]]+b[t[e+11]]+b[t[e+12]]+b[t[e+13]]+b[t[e+14]]+b[t[e+15]]).toLowerCase();if(!g(r)){throw TypeError("Stringified UUID is invalid")}return r}function k(t,e,r){t=t||{};var n=t.random||(t.rng||h)();n[6]=n[6]&15|64;n[8]=n[8]&63|128;if(e){r=r||0;for(var i=0;i<16;++i){e[r+i]=n[i]}return e}return w(n)}var x=":host{--overlay-bg-color:rgba(0, 0, 0, 0.15)}.album-container{-webkit-box-sizing:border-box;box-sizing:border-box;max-width:100%;margin:0 auto;padding:0 2rem}.grid-row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:-1rem -1rem;padding-bottom:3rem}.grid-item{position:relative;-ms-flex:1 0 22rem;flex:1 0 22rem;-ms-flex-positive:1;flex-grow:1;margin:1rem;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}amplify-s3-image{--width:22rem;--height:20rem;border-radius:5px;-o-object-fit:cover;object-fit:cover}.img-overlay{display:none;width:100%;height:21rem;position:absolute;top:0;left:0;background-color:var(--overlay-bg-color)}.grid-item:hover .img-overlay{display:block}";var _=new n("S3Album");var T=t("amplify_s3_album",function(){function t(t){var r=this;e(this,t);this.contentType="binary/octet-stream";this.level=o.Public;this.picker=true;this.pickerText=s.PICKER_TEXT;this.albumItems=[];this.imgArr={};this.list=function(){return __awaiter(r,void 0,void 0,(function(){var t,e,r,n,i,a,o,s;return __generator(this,(function(c){switch(c.label){case 0:t=this,e=t.path,r=e===void 0?"":e,n=t.level,i=t.track,a=t.identityId;_.debug("Album path: "+r);if(!u||typeof u.list!=="function"){throw new Error(l)}c.label=1;case 1:c.trys.push([1,3,,4]);return[4,u.list(r,{level:n,track:i,identityId:a})];case 2:o=c.sent();this.marshal(o);return[3,4];case 3:s=c.sent();_.warn(s);return[3,4];case 4:return[2]}}))}))};this.marshal=function(t){t.forEach((function(t){var e=t.key.toLowerCase();var n=e.split(".")[1];if(c.has(n)){if(!t.contentType||t.contentType&&t.contentType==="binary/octet-stream"){t.contentType=r.getContentType(t)}}}));var e=t.filter((function(t){return t.contentType&&t.contentType.startsWith("image/")}));var n=r.filter?r.filter(e):e;n=r.sort?r.sort(n):n;r.albumItems=n;_.debug("album items",r.albumItems);r.constructImgArray(r.albumItems)};this.constructImgArray=function(t){t.map((function(t){r.imgArr[""+t["key"]]=t["key"]}))};this.handlePick=function(t){return __awaiter(r,void 0,void 0,(function(){var e,r,n,i,a,o,s,l,u,c;return __generator(this,(function(m){switch(m.label){case 0:e=t.target.files[0];r=this,n=r.path,i=n===void 0?"":n,a=r.level,o=r.track,s=r.fileToKey;l=i+f(e,s);m.label=1;case 1:m.trys.push([1,3,,4]);return[4,p(l,e,a,o,e["type"],_)];case 2:m.sent();return[3,4];case 3:u=m.sent();_.error(u);throw new Error(u);case 4:if(Object.keys(this.imgArr).includes(l)){this.albumItems=__spreadArrays(this.albumItems);this.imgArr[l]=l+"-"+k()}else{c=__spreadArrays(this.albumItems,this.filter?this.filter([{key:l}]):[{key:l}]);this.albumItems=this.sort?this.sort(c):c}return[2]}}))}))}}t.prototype.getContentType=function(t){return i(t.key,"image/*")};t.prototype.componentWillLoad=function(){this.list()};t.prototype.render=function(){var t=this;return r("div",null,r("div",{class:"album-container"},r("div",{class:"grid-row"},this.albumItems.map((function(e){return r("div",{class:"grid-item",key:"key-"+e.key},r("amplify-s3-image",{key:t.imgArr[e.key],imgKey:e.key,level:t.level,path:t.path,identityId:t.identityId,track:t.track,handleOnError:t.handleOnError,handleOnLoad:t.handleOnLoad}),r("span",{class:"img-overlay"}))})))),this.picker&&r("amplify-picker",{pickerText:a.get(this.pickerText),inputHandler:function(e){return t.handlePick(e)},acceptValue:"image/*"}))};return t}());T.style=x}}}));